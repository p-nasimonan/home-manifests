# Minecraft サーバー設定
# itzg/minecraft-server Helm Chart 用の values.yaml
# ラッパーチャート構造: 全ての設定を minecraft: の下にネスト

minecraft:
  minecraftServer:
    eula: "TRUE"
    version: "1.20.4"
    type: "PAPER"  # 軽量サーバー（VANILLA より推奨）
    difficulty: "normal"
    motd: "Welcome to My Home K3s Server"
    memory: 4G    # メモリ割り当て
    maxPlayers: 20
    allowNether: true
    enableCommandBlock: true
    generateStructures: true
    hardcore: false
    spawnAnimals: true
    spawnMonsters: true
    spawnNPCs: true
    viewDistance: 10
    gameMode: survival
    
    env:
      OPS: "Youkan0124"
  
  service:
    type: LoadBalancer
    # サーバーに割り当てる固定IPを指定
    loadBalancerIP: 192.168.0.220
    port: 25565
  
  persistence:
    dataDir:
      enabled: true
      size: 20Gi
      storageClassName: nfs-client
  
  resources:
    requests:
      memory: 2Gi
      cpu: 500m
    limits:
      memory: 4Gi
      cpu: 2000m
  
  # ヘルスチェック設定（Java起動遅延を許す設定）
  livenessProbe:
    initialDelaySeconds: 60   # 最初の60秒はチェックしない
    periodSeconds: 10         # 10秒ごとにチェック
    failureThreshold: 30      # 30回失敗まで許す（＝300秒待機）
    timeoutSeconds: 5         # 返答待ち時間を5秒に延長
    
  readinessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
    failureThreshold: 30
    timeoutSeconds: 5
